(window.LearnosityAmd=window.LearnosityAmd||[]).push([[65],{452:function(e,t,n){"use strict";var i=n(0),o=n.n(i),r=n(35),a=n(10);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=["exactMatch","partialMatch","partialMatchV2"],l=function isEmptyValidResponse(e){var t=o.a.getNested(e,"valid_response.value");return o.a.isEmpty(t)},c=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(McqScorer,e);var t=_createSuper(McqScorer);function McqScorer(){return _classCallCheck(this,McqScorer),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(McqScorer,[{key:"getScoringData",value:function getScoringData(){return JSON.parse(JSON.stringify(this.scoringData))}},{key:"reset",value:function reset(e){var t=JSON.stringify(e);if(this.serializedData!==t){try{this.scoringData=function getScoringData(e){var t=e.question.validation,n=[];if(!function canValidateResponse(e){return!1!==o.a.getNested(e,"validation.automarkable")&&(e.valid_responses||e.validation&&(!l(e.validation)||!o.a.isEmpty(e.validation.alt_responses)))}(e.question))return{automarkable:!1};if(e.response=e.response||{},t&&t.scoring_type){if(!o.a.contains(s,t.scoring_type))throw new a.a.InvalidScoringTypeException(e.question.type,t.scoring_type);return t.valid_response&&n.push(t.valid_response),t.alt_responses&&(n=n.concat(t.alt_responses)),function processResponsesCurrentScoringFormat(e,t){var n={score:1,penaltyScore:0};return a.a.scoreArray(e,t,n,{ignoreOrder:!0})}(e,n)}return function processLegacyResponsesPre2140(e){var t,n=e.question.valid_responses,i=e.response&&e.response.value,r=(Math.abs(o.a.isNumber(e.question.penalty_score)?e.question.penalty_score:0),!0===e.question.multiple_responses),a=!0,s=[];i?(o.a.isArray(i)||(i=[i]),o.a.each(i,(function(e){var t,i=!1;for(t=0;t<n.length&&(n[t].value!=e||(i=!0,r));t++);i?s.push(!0):(s.push(!1),a=!1)})),r?(t=s.length===n.length&&o.a.all(s)?1:0,a=1===t):t=o.a.all(s)?1:0):a=null;return{score:t,responsesValid:s,maxScore:1,isValid:a}}(e=a.a.normalizeParameters(e))}(JSON.parse(JSON.stringify(e))),a.a.normalizeScores(this.scoringData,e)}catch(e){this.scoringData={error:e}}this.serializedData=t}return this}}]),McqScorer}(r.a);t.a=c},86:function(e,t,n){"use strict";n.r(t);var i=n(0),o=n.n(i),r=n(51),a=n(17),s=n.n(a),l=n(452),c=n(158),u=r.a.extend({initialize:function initialize(){r.a.prototype.initialize.apply(this,arguments),this.shuffleService=new c.a(this,{key:"options"})},getOrderedOptions:function getOrderedOptions(){return this.shuffleService.get("options")},validateStartup:function validateStartup(){r.a.prototype.validateStartup.call(this),this.get("question").options&&o.a.each(this.get("question").options,(function(e){e.value=s.a.sanitizeHTML(e.value),e.label=s.a.sanitizeHTML(e.label)})),this.get("question").valid_responses&&o.a.each(this.get("question").valid_responses,(function(e){e.value&&(e.value=s.a.sanitizeHTML(e.value))}))},processResponseValue:function processResponseValue(e){this.hasResponse()||this.set({response:{value:[],type:this.RESPONSE_TYPE.ARRAY}},{silent:!0}),this.get("response").type===this.RESPONSE_TYPE.STRING&&(this.get("response").type=this.RESPONSE_TYPE.ARRAY),this.get("response").value=e},mapValidationMetadataToResponseState:function mapValidationMetadataToResponseState(e){var t,n,i,r,a,s="unattempted"===e.targetState,l=this.shuffleService.mapValueBasedOnOptionOrder(e.metadata);return s?i=this.getUnattemptedValues():(t="correct"===e.targetState,n=this.getResponseValidDetailed().partial,r=this.getMappableResponses(),i=o.a.filter(r,(function(e,i){return n[i]===t}))),a=this.getIndexesForResponseValues(i),o.a.map(a,(function(e,t){return{metadata:l[e],value:s?null:i[t],index:e}}))},getUnattemptedValues:function getUnattemptedValues(){return o.a.chain(this.get("question").options).pluck("value").difference(this.getMappableResponses()).value()},getIndexesForResponseValues:function getIndexesForResponseValues(e){var t=o.a.pluck(this.getOrderedOptions(),"value");return o.a.map(e,(function(e){return o.a.indexOf(t,e)}))},getScorerClass:function getScorerClass(){return l.a},validateResponse:function validateResponse(){return this.getScorer().validateIndividualResponses()},allowsMultipleResponses:function allowsMultipleResponses(){var e=this.get("question");return e.hasOwnProperty("multiple_responses")&&e.multiple_responses}}),p=n(179),f=n(125),d=n.n(f),y=n(129),h=n(127),b=n(126),m=n.n(b),v=n(183),_=n(180),g=n(21),S=n(23),O={MCQ_SELECT_OPTION:"mcq:selectOption",MCQ_UPDATE_SELECTED_OPTIONS:"mcq:updateSelectedOptions"};var R={actionTypes:O,selectOption:function selectOption(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return function(n,i){n(S.a.clearValidationUI()),n({type:O.MCQ_SELECT_OPTION,payload:{option:e,allowsMultipleResponses:t}});var r=o.a.map(i().mcq.selectedOptions,(function(e){return e.value}));n(g.a.updateResponseValue(r))}},updateSelectedOptions:function updateSelectedOptions(e){return{type:O.MCQ_UPDATE_SELECTED_OPTIONS,payload:{options:e}}}},P=n(142);function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function _createSuper(e){var t=function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,i=_getPrototypeOf(e);if(t){var o=_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var C=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}(OptionInput,e);var t=_createSuper(OptionInput);function OptionInput(){return _classCallCheck(this,OptionInput),t.apply(this,arguments)}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}(OptionInput,[{key:"componentDidUpdate",value:function componentDidUpdate(){this.props.shouldFocus?this.input.focus():this.input.blur()}},{key:"isAriaHidden",value:function isAriaHidden(){var e=this.props.inMaskingState,t=this.input&&-1===this.input.tabIndex;return e||t}},{key:"render",value:function render(){var e=this,t=this.props,n=t.responseId,i=t.isSelected,o=t.allowsMultipleResponses,r=t.value,a=t.index,s=t.readOnly,l=t.onChange,c=t.onKeyDown,u=t.onInputFocus,p=o?"checkbox":"radio",f="".concat(n,"_").concat(a);return d.a.createElement("input",{id:f,className:"lrn-input",type:p,name:n,value:r,disabled:s,onChange:l,checked:i,onKeyDown:c,onFocus:function onFocus(){return u(a)},ref:function ref(t){return e.input=t},"aria-hidden":this.isAriaHidden()})}}]),OptionInput}(d.a.Component),T=n(134);function optionLabel_typeof(e){return(optionLabel_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function optionLabel_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function optionLabel_defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function optionLabel_setPrototypeOf(e,t){return(optionLabel_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function optionLabel_createSuper(e){var t=function optionLabel_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,i=optionLabel_getPrototypeOf(e);if(t){var o=optionLabel_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return optionLabel_possibleConstructorReturn(this,n)}}function optionLabel_possibleConstructorReturn(e,t){return!t||"object"!==optionLabel_typeof(t)&&"function"!=typeof t?optionLabel_assertThisInitialized(e):t}function optionLabel_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function optionLabel_getPrototypeOf(e){return(optionLabel_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var E=function(e){!function optionLabel_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&optionLabel_setPrototypeOf(e,t)}(OptionLabel,e);var t=optionLabel_createSuper(OptionLabel);function OptionLabel(){var e;optionLabel_classCallCheck(this,OptionLabel);for(var n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];return _defineProperty(optionLabel_assertThisInitialized(e=t.call.apply(t,[this].concat(i))),"state",{screenReaderElement:null}),e}return function optionLabel_createClass(e,t,n){return t&&optionLabel_defineProperties(e.prototype,t),n&&optionLabel_defineProperties(e,n),e}(OptionLabel,[{key:"componentDidMount",value:function componentDidMount(){var e=this.getScreenReaderElement();this.setState({screenReaderElement:e})}},{key:"getScreenReaderElement",value:function getScreenReaderElement(){var e=T.a.getAriaLabelFromAllElements(this.props.label);return T.a.getText(e,!0)}},{key:"render",value:function render(){var e=this,t=this.props,n=t.ariaHidden,i=t.choiceLabel,o=t.displayType,r=t.index,a=t.label,s=t.disabled,l=!!i&&"block"===o,c=!(a.indexOf("learnosity-feature")>-1);return d.a.createElement("div",{className:"lrn-possible-answer","aria-hidden":n},function buildLabel(){return l?d.a.createElement("span",{className:"lrn_choiceLabel"},Object(P.a)(i,r)):null}(),function buildContent(){var e=m()({lrn_singleRow:l,"lrn-label-disabled":s},"lrn_contentWrapper");return(d.a.createElement("div",{className:e,"aria-hidden":c,dangerouslySetInnerHTML:{__html:a}}))}(),c&&function buildSROnly(){var t=e.state.screenReaderElement;return(d.a.createElement("div",{className:"sr-only"},t))}())}}]),OptionLabel}(d.a.Component),q=n(210),w=n(14),M=n(187),L=n(131),k=n(327),I=n.n(k);function mcq_typeof(e){return(mcq_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function mcq_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function mcq_defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function mcq_setPrototypeOf(e,t){return(mcq_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function mcq_createSuper(e){var t=function mcq_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,i=mcq_getPrototypeOf(e);if(t){var o=mcq_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return mcq_possibleConstructorReturn(this,n)}}function mcq_possibleConstructorReturn(e,t){return!t||"object"!==mcq_typeof(t)&&"function"!=typeof t?mcq_assertThisInitialized(e):t}function mcq_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function mcq_getPrototypeOf(e){return(mcq_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function mcq_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function getOptionValidationClassName(e,t,n,i){var r=t.CORRECT,a=t.INCORRECT,s=t.VALID,l=e.validatedResponses,c=e.suggestedResponses,u=c&&c.value,p=!o.a.isEmpty(l)&&null!==l[i],f=u&&c.value.indexOf(n)>=0;return p?l[i]?r:a:e.isShowingCorrectAnswers&&f?s:""}function getResponseAccessibilityState(e,t){var n=t.CORRECT,i=t.INCORRECT,o=t.VALID,r=T.a.STATES;return e===n?r.CORRECT:e===i?r.INCORRECT:e===o?r.VALID:void 0}function getWrapperStyle(e){var t=e.columns,n=100;return t>0&&(n=100/t),{width:"".concat(n,"%")}}var x={indexToFocus:null,isMinSelectionWarningVisible:!1,isMaxSelectionWarningVisible:!1},D=function(e){!function mcq_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&mcq_setPrototypeOf(e,t)}(MCQ,e);var t=mcq_createSuper(MCQ);function MCQ(){var e,n,i;mcq_classCallCheck(this,MCQ);for(var r=arguments.length,a=new Array(r),s=0;s<r;s++)a[s]=arguments[s];return mcq_defineProperty(mcq_assertThisInitialized(e=t.call.apply(t,[this].concat(a))),"CLASSNAMES",{SELECTED:"lrn_selected",CORRECT:"lrn_correct",INCORRECT:"lrn_incorrect",VALID:"lrn_valid"}),mcq_defineProperty(mcq_assertThisInitialized(e),"state",x),mcq_defineProperty(mcq_assertThisInitialized(e),"maskedOptions",(n={},i=e.props.mcq.options,o.a.each(i,(function(e,t){return n[t]=!1})),n)),mcq_defineProperty(mcq_assertThisInitialized(e),"shouldUpdateOptionOnKeyEvent",!e.props.mcq.allowsMultipleResponses),mcq_defineProperty(mcq_assertThisInitialized(e),"focusedIndex",null),mcq_defineProperty(mcq_assertThisInitialized(e),"buildOption",(function(t,n){var i,r=e.props,a=e.CLASSNAMES,s=r.mcq,l=r.validatable,c=r.base,u=s.uiStyle,p=s.minSelection,f=s.maxSelection,y=u.inputBelowLabel,h=a.SELECTED,b=o.a.contains(s.selectedOptions,t),v=e.state,_=v.isMaxSelectionWarningVisible,g=v.isMinSelectionWarningVisible,S=getOptionValidationClassName(l,a,t,n),O=c.i18n.labels.ariaLiveText,R=T.a.getResponseAccessibility({validationState:l.ariaGlobal.label,isMath:c.isMath,value:t.label,state:getResponseAccessibilityState(S,a),ariaLiveLabels:O,isMaxSelectionWarningVisible:_,isMinSelectionWarningVisible:g,minSelection:p,maxSelection:f}),P=e.makeValidationStemNumerationLabel(t),C=e.makeInput(t,b),E=e.makeLabel(t,R,b),q=m()("lrn-mcq-option",S,(mcq_defineProperty(i={},h,!0===b),mcq_defineProperty(i,"has_stem_numeration",!o.a.isNull(P)),i));return y?d.a.createElement("li",{key:n,style:getWrapperStyle(u),className:q},P,E,C):d.a.createElement("li",{key:n,style:getWrapperStyle(u),className:q},P,C,E)})),mcq_defineProperty(mcq_assertThisInitialized(e),"onKeyDown",(function(t){var n=mcq_assertThisInitialized(e).focusedIndex,i=e.props.mcq.options,o=t.keyCode;40===o||39===o?(t.preventDefault(),n=n<i.length-1?n+1:0,e.applyFocus(n,!0)):38!==o&&37!==o||(t.preventDefault(),n=n<1?i.length-1:n-1,e.applyFocus(n,!1))})),mcq_defineProperty(mcq_assertThisInitialized(e),"onInputFocus",(function(t){e.focusedIndex=t})),e}return function mcq_createClass(e,t,n){return t&&mcq_defineProperties(e.prototype,t),n&&mcq_defineProperties(e,n),e}(MCQ,[{key:"reset",value:function reset(){this.setState(x)}},{key:"makeValidationStemNumerationLabel",value:function makeValidationStemNumerationLabel(e){var t=this.props.mcq.uiStyle,n=t.choiceLabel,i=t.type,o=this.props.validatable,r=o.responseLevelDistractorRationale,a=o.showDistractorRationale,s=o.validationState,l=o.validationStemNumeration,c=Object(w.h)(r,a.perResponse);if(n&&"block"===i||!s||0===c.length)return null;var u=Object(P.a)(l,e.defaultIndex);return(d.a.createElement("span",{className:"lrn-validation-stem-numeration"},u))}},{key:"makeInput",value:function makeInput(e,t){var n=this,i=e.defaultIndex,o=this.props,r=o.base,a=o.mcq,s=this.state.indexToFocus,l=r.inMaskingState,c=r.responseId,u=r.readOnly,p=r.disabled,f=a.uiStyle,y=a.allowsMultipleResponses,h=l||u||p||!0===this.maskedOptions[i],b=s===i;return d.a.createElement(C,{index:i,allowsMultipleResponses:y,responseId:c,readOnly:h,displayType:f.type,value:e.value,isSelected:t,onChange:function onChange(){return n.toggleOptionSelection(e,i)},shouldFocus:b,onInputFocus:this.onInputFocus,onKeyDown:this.onKeyDown,inMaskingState:l})}},{key:"makeLabel",value:function makeLabel(e,t,n){var i=this,r=e.defaultIndex,a=this.props,s=a.base,l=a.mcq,c=s.responseId,u=s.inMaskingState,p=l.uiStyle,f=l.selectedOptions,y=l.maxSelection,h="".concat(c,"_").concat(r),b=this.makeAriaText(t),m=u||t.visible,v=o.a.findWhere(f,e),_=y===f.length&&!v;return d.a.createElement(d.a.Fragment,null,d.a.createElement("label",{className:"lrn-label",htmlFor:h},b,d.a.createElement(E,{index:r,label:e.label,displayType:p.type,choiceLabel:p.choiceLabel,ariaHidden:m,disabled:_})),d.a.createElement(q.a,{hidden:n,onChange:function onChange(e){return i.maskedOptions[r]=e},ariaLabel:e.maskableAriaLabel}))}},{key:"makeAriaText",value:function makeAriaText(e){return d.a.createElement(_.a.ScreenReaderAriaText,{data:e})}},{key:"toggleOptionSelection",value:function toggleOptionSelection(e,t){var n=this.props,i=n.mcqActions,r=n.mcq,a=r.allowsMultipleResponses,s=r.minSelection,l=r.maxSelection,c=r.selectedOptions,u=o.a.findWhere(c,e);l!==c.length||u?(i.selectOption(e,a),a&&s&&this.setState({isMinSelectionWarningVisible:s>c.length}),this.setState({indexToFocus:t,isMaxSelectionWarningVisible:!1})):this.setState({indexToFocus:t,isMaxSelectionWarningVisible:!0})}},{key:"applyFocus",value:function applyFocus(e,t){var n=function getNextFocusableIndex(e,t,n){if(e[t]){var i=[];if(o.a.each(e,(function(e,o){e||(n&&o>t||!n&&o<t)&&i.push(parseInt(o,10))})),n||i.reverse(),!i.length)return!1;t=i[0]}return t}(this.maskedOptions,e,t);if(!1!==n)if(this.focusedIndex=n,this.shouldUpdateOptionOnKeyEvent){var i=this.props.mcq.options[n];this.toggleOptionSelection(i,i.defaultIndex)}else this.setState({indexToFocus:n})}},{key:"componentDidMount",value:function componentDidMount(){var e=this.props,t=e.mcq,n=e.base,i=t.options,r=n.isMath;o.a.each(i,(function(e){e.maskableAriaLabel=T.a.getText(e.label,r)}))}},{key:"UNSAFE_componentWillReceiveProps",value:function UNSAFE_componentWillReceiveProps(e){var t=e.base,n=e.validatable,i=e.mcq,o=t.isResumeState,r=t.isReviewState,a=t.isAttempted,s=i.minSelection,l=i.selectedOptions;n.validatedResponses&&null!==this.focusedIndex&&(this.focusedIndex=null,this.setState({indexToFocus:null})),(o||r)&&this.setState({isMinSelectionWarningVisible:a&&s>l.length})}},{key:"messageTypeHelper",value:function messageTypeHelper(){var e=this.state,t=e.isMaxSelectionWarningVisible,n=e.isMinSelectionWarningVisible;return t?this.messageType="warning":n&&(this.messageType="info"),this.messageType}},{key:"getWarningMessage",value:function getWarningMessage(){var e=this.state,t=e.isMaxSelectionWarningVisible,n=e.isMinSelectionWarningVisible,i=this.props.mcq,o=i.maxSelection,r=i.minSelection,a=this.props.base.i18n.labels,s=a.minResponseMessage,l=a.minResponsesMessage,c=a.maxResponseMessage,u=a.maxResponsesMessage;return t?o>1?Object(L.a)(u,{maxSelection:o}):c:n?r>1?Object(L.a)(l,{minSelection:r}):s:null}},{key:"render",value:function render(){var e=this.props,t=e.base,n=e.mcq,i=t.responseId,r=t.i18n,a=n.uiStyle,s=n.options,l=this.getValidatableStateClassName(),c=m()({"lds-message--horizontal-centered":"horizontal-input-bottom"===a.type}),u=this.getWarningMessage();return d.a.createElement(v.a.ValidatableQuestion,null,d.a.createElement("div",{role:"group","aria-label":r.labels.ariaLabel.mcq.responses},d.a.createElement("ul",{className:"lrn-response-validate-wrapper lrn_mcqgroup lrn_mcqgroup-".concat(a.type," ").concat(l),"aria-labelledby":"stimulus-".concat(i),role:"presentation"},o.a.map(s,this.buildOption))),d.a.createElement("span",{className:"sr-only","aria-live":"assertive"},u),d.a.createElement(I.a,{className:c,type:this.messageTypeHelper(),iconClassMapping:{info:"lrn-icon-info",warning:"lrn-icon-warning"},animation:{enter:M.a,leave:M.b},visibility:null!==u,ariaHidden:!0},u))}},{key:"getValidatableStateClassName",value:function getValidatableStateClassName(){var e=this.props,t=e.base,n=e.validatable;if(!t.isAttempted||!n.canShowGlobalValidationUI)return"";var i=n.validationState;return"correct"===i?"lrn_correct":"incorrect"===i?"lrn_incorrect":""}}]),MCQ}(d.a.Component),N=D=h.b((function(e){return{base:e.base,validatable:e.validatable,mcq:e.mcq}}),(function(e){return{mcqActions:y.b(R,e)}}),null,{forwardRef:!0})(D);function dataService_typeof(e){return(dataService_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function _typeof(e){return typeof e}:function _typeof(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function dataService_classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function dataService_defineProperties(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function _get(e,t,n){return(_get="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function _get(e,t,n){var i=function _superPropBase(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=dataService_getPrototypeOf(e)););return e}(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}})(e,t,n||e)}function dataService_setPrototypeOf(e,t){return(dataService_setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e})(e,t)}function dataService_createSuper(e){var t=function dataService_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,i=dataService_getPrototypeOf(e);if(t){var o=dataService_getPrototypeOf(this).constructor;n=Reflect.construct(i,arguments,o)}else n=i.apply(this,arguments);return dataService_possibleConstructorReturn(this,n)}}function dataService_possibleConstructorReturn(e,t){return!t||"object"!==dataService_typeof(t)&&"function"!=typeof t?function dataService_assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function dataService_getPrototypeOf(e){return(dataService_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var V,A=function(e){!function dataService_inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&dataService_setPrototypeOf(e,t)}(MCQDataService,e);var t=dataService_createSuper(MCQDataService);function MCQDataService(){return dataService_classCallCheck(this,MCQDataService),t.apply(this,arguments)}return function dataService_createClass(e,t,n){return t&&dataService_defineProperties(e.prototype,t),n&&dataService_defineProperties(e,n),e}(MCQDataService,[{key:"getInitialState",value:function getInitialState(){var e=_get(dataService_getPrototypeOf(MCQDataService.prototype),"getInitialState",this).call(this),t=e.validatable;return t=o.a.extend(t,{ariaGlobal:{visible:this.isReviewState,label:this.getValidatableAriaLabel()}}),"block"===this.displayType&&this.choiceLabel&&(t.validationStemNumeration=this.choiceLabel),o.a.extend(e,{mcq:{selectedOptions:this.selectedOptions,options:this.options,allowsMultipleResponses:this.allowsMultipleResponses,uiStyle:{choiceLabel:this.choiceLabel,type:this.displayType,orientation:this.orientation,columns:this.columns,inputBelowLabel:"horizontal-input-bottom"===this.displayType},minSelection:this.minSelection,maxSelection:this.maxSelection},validatable:t})}},{key:"getValidatableAriaLabel",value:function getValidatableAriaLabel(){if(this.isReviewState){var e=this.VALIDATION_STATES,t=e.CORRECT,n=e.INCORRECT;return this.isResponseValid()?t:n}}},{key:"getValidatedResponses",value:function getValidatedResponses(){var e=this.getResponse();if(e){var t=e.value||[],n=this.validateResponse(),i=this.options;if(!n)return;return o.a.map(i,(function(e){var i=t.indexOf(e.value);return i>=0?n[i]:null}))}}},{key:"getMappedValidatedResponsesData",value:function getMappedValidatedResponsesData(e){var t=this.options;return o.a.map(e,(function(e,n){return{validatedValue:e,text:t[n].plainText}}))}},{key:"getMappedSuggestedResponsesData",value:function getMappedSuggestedResponsesData(e){var t=[];return o.a.each(e,(function(e){o.a.isUndefined(e)||t.push({text:e.plainText})})),t}},{key:"getSuggestedResponses",value:function getSuggestedResponses(){var e=_get(dataService_getPrototypeOf(MCQDataService.prototype),"getSuggestedResponses",this).call(this),t=this.options;return{value:o.a.map(e.value,(function(e){return o.a.findWhere(t,{value:e})}))}}},{key:"_prepareLabelColumns",value:function _prepareLabelColumns(e,t){for(var n=[],i=e.length,o=0;o<t;o++)for(var r=o;r<i;r+=t)n[r]=e.shift();return n}},{key:"canShowGlobalValidationUI",get:function get(){var e=o.a.getNested(this.question,"validation.scoring_type");return(!e||"exactMatch"===e)&&_get(dataService_getPrototypeOf(MCQDataService.prototype),"canShowGlobalValidationUI",this)}},{key:"selectedOptions",get:function get(){var e=o.a.getNested(this.getResponse(),"value")||[],t=this.options;return o.a.chain(e).map((function(e){return o.a.findWhere(t,{value:e})})).compact().value()}},{key:"options",get:function get(){if(o.a.isUndefined(this.data.options)){var e=this.model.getOrderedOptions(),t=this.orientation,n=this.columns;o.a.each(e,(function(e,t){return e.defaultIndex=t})),n>1&&"vertical"===t&&(e=this._prepareLabelColumns(e,n)),this.data.options=o.a.map(e,(function(e){var t=s.a.sanitizeHTML(e.value),n=s.a.sanitizeHTML(e.label);return{value:t,label:n,plainText:T.a.getAriaLabelFromAllElements(n),defaultIndex:e.defaultIndex}}))}return this.data.options}},{key:"choiceLabel",get:function get(){if(o.a.isUndefined(this.data.choiceLabel)){var e=this.question,t=o.a.getNested(e,"ui_style.choice_label");o.a.contains(["number","lower-alpha","upper-alpha"],t)&&(this.data.choiceLabel=t)}return this.data.choiceLabel}},{key:"displayType",get:function get(){return o.a.getNested(this.question,"ui_style.type")||"vertical"}},{key:"allowsMultipleResponses",get:function get(){return!!this.question.multiple_responses}},{key:"orientation",get:function get(){if(o.a.isUndefined(this.data.orientation)){var e=o.a.getNested(this.question,"ui_style.orientation");this.data.orientation=o.a.contains(["horizontal","vertical"],e)?e:"vertical"}return this.data.orientation}},{key:"columns",get:function get(){var e=o.a.getNested(this.question,"ui_style.columns");return parseInt(e,10)}},{key:"minSelection",get:function get(){var e=this.question.min_selection;return e||0}},{key:"maxSelection",get:function get(){var e=this.question.max_selection;return e||1/0}}]),MCQDataService}(n(55).a),j=n(25);function reducer_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var z=R.actionTypes,F=(reducer_defineProperty(V={},z.MCQ_SELECT_OPTION,(function(e,t){var n=t.option,i=t.allowsMultipleResponses,o=e.selectedOptions;if(i){var r=o.indexOf(n);r>=0?o.splice(r,1):o.push(n)}else o=[n];return{selectedOptions:o}})),reducer_defineProperty(V,z.MCQ_UPDATE_SELECTED_OPTIONS,(function(e,t){return{selectedOptions:t.options}})),V),W=Object(j.a)(F,{selectedOptions:[]}),Q=p.a.extend({maskable:!0,ViewComponent:N,DataService:A,forwardRef:!0,getReducers:function getReducers(){var e=p.a.prototype.getReducers.apply(this,arguments);return o.a.extend(e,{mcq:W})},addFacadeMethods:function addFacadeMethods(e){var t,n=this.getDataService();e.getProcessedOptions=function(){if(o.a.isUndefined(t)){var e=n.options,i=n.choiceLabel;t=o.a.map(e,(function(e,t){return{label:e.label,value:e.value,choice_label:Object(P.a)(i,t)}}))}return t},e.isValid=o.a.wrap(e.isValid,(function(t,i){var r=t.call(e,i);if(r&&i){var a=o.a.getNested(n.getResponse(),"value")||[],s=r.partial;r.partial=o.a.map(n.options,(function(e){var t=a.indexOf(e.value);return s&&t>=0?s[t]:null}))}return r}))}});t.default={View:Q,Model:u}}}]);